<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, minimal-ui"
    />
    <title>$title$</title>
    <style>
      $if(highlighting-css)$
        $highlighting-css$
      $endif$

      $if(css)$
        $css$
      $endif$
    </style>
  </head>
  <body class="markdown-body">
    $body$

    <script type="module">
      import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.esm.min.mjs";

      document.addEventListener("DOMContentLoaded", function () {
        // NOTE: this fixes the <code> inside <pre> issue
        document
          .querySelectorAll("pre.mermaid code")
          .forEach(function (codeBlock) {
            // Create a new <div> for the Mermaid diagram
            const mermaidDiv = document.createElement("div");
            mermaidDiv.className = "mermaid";
            mermaidDiv.textContent = codeBlock.textContent;

            // Replace the <pre> element with the new <div>
            codeBlock.parentNode.replaceWith(mermaidDiv);
          });

        mermaid.initialize({
          startOnLoad: true,
          theme: "dark",
          logLevel: 4,
          flowchart: { 
            useMaxWidth: true, htmlLabels: true 
          },
        });
      });
    </script>
  </body>
</html>
